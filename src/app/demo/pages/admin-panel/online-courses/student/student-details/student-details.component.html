<div class="dialog-head" mat-dialog-title>
  <div class="head-row">
    <div class="title">بيانات الطالب</div>

    <button mat-icon-button class="close-btn" mat-dialog-close aria-label="إغلاق">
      <i class="ti ti-x"></i>
    </button>
  </div>
</div>

<mat-dialog-content class="dialog-content">

  <div class="loading-state" *ngIf="loading">
    <mat-spinner diameter="48"></mat-spinner>
    <div class="loading-text">جاري تحميل البيانات...</div>
  </div>

  <app-scrollbar *ngIf="!loading && vm as s" [customStyle]="{ maxHeight: 'calc(100vh - 155px)', position: 'relative' }">

    <div class="wrap">

      <!-- ====== Header Card ====== -->
      <section class="card hero">
        <div class="hero-left">
          <div class="avatar">
            <i class="ti ti-user"></i>
          </div>

          <div class="hero-meta">
            <div class="name">{{ s.fullName || '—' }}</div>

            <div class="sub">
              <span class="pill">
                <i class="ti ti-building-store"></i>
                {{ getBranchLabel(s.branchId) }}
              </span>

              <!-- <span class="pill" *ngIf="s.inactive !== undefined" [class.is-inactive]="!!s.inactive">
                <i class="ti" [class.ti-circle-check]="!s.inactive" [class.ti-circle-x]="!!s.inactive"></i>
                {{ s.inactive ? 'غير نشط' : 'نشط' }}
              </span> -->
            </div>
          </div>
        </div>

        <div class="hero-right" *ngIf="statEntries.length">
          <div class="mini" *ngFor="let st of statEntries">
            <div class="mini-k">{{ st.label }}</div>
            <div class="mini-v">{{ st.value || '—' }}</div>
          </div>
        </div>
      </section>

      <!-- ====== Contact Card ====== -->
      <section class="card" *ngIf="contactEntries.length">
        <div class="card-title">
          <i class="ti ti-address-book"></i>
          بيانات التواصل
        </div>

        <div class="contact-grid">
          <a class="contact-item"
             *ngFor="let c of contactEntries"
             [href]="c.href || null"
             [class.is-link]="!!c.href"
             (mousedown)="onContactPressStart(c.value, $event)"
             (mouseup)="onContactPressEnd()"
             (mouseleave)="onContactPressEnd()"
             (touchstart)="onContactPressStart(c.value, $event)"
             (touchend)="onContactPressEnd()"
             (touchcancel)="onContactPressEnd()"
             (click)="onContactClick($event)">

            <div class="c-ico"><i [class]="c.icon"></i></div>
            <div class="c-body" *ngIf="!isCompactContact(c.key)">
              <div class="c-label">{{ c.label }}</div>
              <div class="c-value">{{ c.value || '—' }}</div>
            </div>

            <i class="ti ti-external-link hint" *ngIf="c.href && !isCompactContact(c.key)"></i>
          </a>
        </div>
      </section>

      <!-- ====== Details Card ====== -->
      <section class="card" *ngIf="detailEntries.length">
        <div class="card-title">
          <i class="ti ti-id"></i>
          البيانات الأساسية
        </div>

        <div class="kv-grid">
          <div class="kv" *ngFor="let e of detailEntries">
            <div class="k">{{ e.label }}</div>
            <div class="v">{{ e.value }}</div>
          </div>
        </div>
      </section>

    </div>

  </app-scrollbar>
</mat-dialog-content>

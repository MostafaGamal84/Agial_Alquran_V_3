<div class="row justify-content-center">
  <div class="col-xl-10 col-lg-11 col-12">
    <app-card cardTitle="إضافة طالب جديد">

      <div class="user-header">
        <h2 class="page-title">إضافة طالب جديد</h2>
        <p class="page-subtitle">
          قم بإدخال البيانات الأساسية وبيانات التواصل ومكان الإقامة لطالب.
        </p>
      </div>

      <form [formGroup]="basicInfoForm" (ngSubmit)="onSubmit()" class="user-form row g-3">

        <!-- ==================== البيانات الأساسية ==================== -->
        <div class="col-12">
          <div class="section-card">
            <div class="section-header">
              <div class="section-icon">
                <mat-icon>person</mat-icon>
              </div>
              <div>
                <h5 class="section-title">البيانات الأساسية</h5>
                <p class="section-subtitle">
                  الاسم الكامل والبريد الإلكتروني وكلمة المرور.
                </p>
              </div>
            </div>

            <div class="row g-3">

              <div class="col-md-6">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>الاسم الكامل</mat-label>
                  <input matInput formControlName="fullName" />
                </mat-form-field>
              </div>

              <div class="col-md-6">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>البريد الإلكتروني</mat-label>
                  <input matInput type="email" formControlName="email" />
                </mat-form-field>
              </div>

              <div class="col-md-6">
                <mat-form-field appearance="outline" class="w-100">
                  <mat-label>كلمة المرور</mat-label>
                  <input matInput type="password" formControlName="passwordHash" />
                </mat-form-field>
              </div>

            </div>
          </div>
        </div>

        <!-- ==================== بيانات التواصل ==================== -->
        <div class="col-12">
          <div class="section-card">
            <div class="section-header">
              <div class="section-icon section-icon-blue">
                <mat-icon>phone</mat-icon>
              </div>
              <div>
                <h5 class="section-title">بيانات التواصل</h5>
                <p class="section-subtitle">
                  الجوال الأساسي والبديل مع مفتاح الدولة.
                </p>
              </div>
            </div>

            <div class="row g-3">

              <div class="col-md-6">
                <label class="form-label form-label-sm">الجوال</label>
                <div class="d-flex gap-2 phone-row">
                  <ng-select
                    [items]="countries"
                    bindLabel="name"
                    bindValue="dialCode"
                    formControlName="mobileCountryDialCode">
                  </ng-select>

                  <mat-form-field appearance="outline" class="w-100">
                    <input matInput formControlName="mobile" />
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-6">
                <label class="form-label form-label-sm">الجوال البديل</label>
                <div class="d-flex gap-2 phone-row">
                  <ng-select
                    [items]="countries"
                    bindLabel="name"
                    bindValue="dialCode"
                    formControlName="secondMobileCountryDialCode">
                  </ng-select>

                  <mat-form-field appearance="outline" class="w-100">
                    <input matInput formControlName="secondMobile" />
                  </mat-form-field>
                </div>
              </div>

            </div>
          </div>
        </div>

        <!-- ==================== الجنسية ومكان الإقامة ==================== -->
        <div class="col-12">
          <div class="section-card">
            <div class="section-header">
              <div class="section-icon section-icon-green">
                <mat-icon>location_on</mat-icon>
              </div>
              <div>
                <h5 class="section-title">الجنسية ومكان الإقامة</h5>
                <p class="section-subtitle">
                  اختر الجنسية ومكان الإقامة والمحافظة والفرع.
                </p>
              </div>
            </div>

            <div class="row g-3">

              <div class="col-md-6">
                <label class="form-label form-label-sm">الجنسية</label>
                <ng-select
                  [items]="nationalities"
                  bindLabel="name"
                  bindValue="id"
                  formControlName="nationalityId">
                </ng-select>
              </div>

              <div class="col-md-6">
                <label class="form-label form-label-sm">مكان الإقامة</label>
                <ng-select
                  [items]="nationalities"
                  bindLabel="name"
                  bindValue="id"
                  formControlName="residentId">
                </ng-select>
              </div>

              <div class="col-md-6" *ngIf="showGovernorateSelect">
                <label class="form-label form-label-sm">المحافظة</label>
                <ng-select
                  [items]="governorates"
                  bindLabel="name"
                  bindValue="id"
                  formControlName="governorateId">
                </ng-select>
              </div>

              <div class="col-md-6">
                <label class="form-label form-label-sm">الفرع</label>
                <ng-select
                  [items]="Branch"
                  bindLabel="label"
                  bindValue="id"
                  formControlName="branchId">
                </ng-select>
              </div>

            </div>
          </div>
        </div>

        <!-- ==================== زر الإرسال ==================== -->
        <div class="col-12 text-end">
          <button mat-flat-button color="primary" type="submit">
            {{ isSubmitting ? 'جاري الإرسال...' : 'إرسال' }}
          </button>

          <div class="text-danger small mt-2" *ngIf="submitValidationMessage">
            {{ submitValidationMessage }}
          </div>
        </div>

      </form>
    </app-card>
  </div>
</div>
